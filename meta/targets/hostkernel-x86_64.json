{
  "$schema": "https://schemas.cute.engineering/stable/cutekit.manifest.target.v1",
  "id": "host-kernel-x86_64",
  "type": "target",
  "props": {
    "toolchain": "clang",
    "arch": "x86_64",
    "bits": "64",
    "sys": "{shell.uname().sysname}",
    "abi": "sysv",
    "loader": "linux",
    "encoding": "utf8",
    "freestanding": false,
    "host": true,
    "kernel": true
  },
  "tools": {
    "cc": {

      "cmd": "{shell.latest('gcc')}",
      "args": [
        "-Isrc/libc",
        "-g",
        "-fno-stack-protector",
        "-mno-80387",
        "-mno-mmx",
        "-mno-3dnow",
        "-mno-sse",
        "-mno-sse2",
        "-D__STRICT_ANSI__",
        "-mno-red-zone",
        "-mcmodel=kernel",
        "-Wno-missing-field-initializers",
        "-std=gnu23",
        "-Wnull-dereference",
        "-Wstack-protector",
        "-Wno-strict-overflow",
        
        "-Walloca",
        "-Wvla",
        "-Wshadow",
        "-fno-pie",
        "-Wswitch-default",
        "-Wfloat-equal",
        "-fsanitize-address-use-after-scope",
        "-Og"
      ]
    },
    "cxx": {

      "cmd": "{shell.latest('g++')}",
      "args": [
        "-Isrc/libc",
        "-g",
        "-fno-exceptions",
        "-fno-rtti",
        "-D__STRICT_ANSI__",
        "-fno-stack-protector",
        "-fno-builtin",
        "-D_NEW",
        "-fno-threadsafe-statics",
        "-mno-80387",
        "-mno-mmx",
        "-mno-3dnow",
        "-fno-pie",
        "-mno-sse",
        "-mno-sse2",
        "-mno-red-zone",
        "-mcmodel=kernel",
        "-Wno-missing-field-initializers",
        "-std=c++2c",
        "-Wnull-dereference",
        "-Wstack-protector",
        "-Wno-strict-overflow",
        
        "-Walloca",
        "-Wvla",
        "-Warray-bounds",
        "-Wshadow",
        "-Wswitch-default",
        "-Wfloat-equal",
        "-Wdangling-reference",
        "-O3"
      ]
    },
    "ld": {
      "cmd": "{shell.latest('ld.lld')}",
      "args": [
        "-T",
        "{utils.relpath('kernel-x86_64.ld')}"
      ],
      "files": ["{utils.relpath('kernel-x86_64.ld')}"]
    },
    "ar": {
      "cmd": "{shell.latest('llvm-ar')}",
      "args": ["rcs"]
    },
    "as": {
      "cmd": "nasm",
      "args": ["-f", "elf64"]
    }
  }
}
